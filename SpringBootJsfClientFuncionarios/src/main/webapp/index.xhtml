<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<f:view contentType="text/html" xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
        xmlns:p="http://primefaces.org/ui">

    <f:metadata>
        <f:viewAction action="#{funcionarioClientBean.inico()}"/>
    </f:metadata>

    <html>

        <h:head>
        </h:head>

        <h:body>

            <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />
            <p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
                <p:graphicImage url="carregando.gif" />
                <p:graphicImage url="spinner.gif" />
            </p:dialog>

            <script type="text/javascript">
                PrimeFaces.locales['pt'] = {
                    closeText: 'Fechar',
                    prevText: 'Anterior',
                    nextText: 'Próximo',
                    currentText: 'Começo',
                    monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                    monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                    dayNames: ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'],
                    dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],
                    dayNamesMin: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S'],
                    weekHeader: 'Semana',
                    firstDay: 1,
                    isRTL: false,
                    showMonthAfterYear: false,
                    yearSuffix: '',
                    timeOnlyTitle: 'Só Horas',
                    timeText: 'Tempo',
                    hourText: 'Hora',
                    minuteText: 'Minuto',
                    secondText: 'Segundo',
                    currentText: 'Data Atual',
                    ampm: false,
                    month: 'Mês',
                    week: 'Semana',
                    day: 'Dia',
                    allDayText: 'Todo Dia'
                };
            </script>

            <h:form id="form">
                <p:messages id="msgs" autoUpdate="true" closable="true"  />
                <p:panel header="URL WebService Rest Funcionários" >
                    <p:inputText required="true" requiredMessage="URL é obrigatorio" id="url" value="#{funcionarioClientBean.URL}" placeholder="URL"  style="width: 40%" />
                    <p:commandButton icon="fa fa-pencil" action="#{funcionarioClientBean.atualizarUrl()}" process="@this url" update="url tabela" oncomplete="$(function(){PrimeFaces.focus('form:nome');});"></p:commandButton>
                </p:panel>
                <p:panel header="Cadastro de Funcionário" >
                    <p:inputText id="id" value="#{funcionarioClientBean.funcionarioEdicao.id}" rendered="false"></p:inputText>
                    <p:inputText required="true" requiredMessage="Nome é obrigatorio" id="nome" value="#{funcionarioClientBean.funcionarioEdicao.nome}" placeholder="Nome"  style="width: 40%" />
                    <p:inputText required="true" requiredMessage="Setor é obrigatorio" id="setor" value="#{funcionarioClientBean.funcionarioEdicao.setor}" placeholder="Setor" style="width: 20%" />
                    <p:calendar showButtonPanel="true" locale="pt" navigator="true" required="true" requiredMessage="Data nascimento é obrigatorio" id="datanascimento" value="#{funcionarioClientBean.funcionarioEdicao.dataNascimento}" placeholder="Data Nascimento" pattern="dd/MM/yyyy" style="width: 10%" />
                    <p:calendar showButtonPanel="true" locale="pt" navigator="true" required="true" requiredMessage="Data contratação é obrigatorio" id="datacontratacao" value="#{funcionarioClientBean.funcionarioEdicao.dataContratacao}" placeholder="Data Contratacao" pattern="dd/MM/yyyy" style="width: 10%" />
                    <br />
                    <br />
                    <p:commandButton action="#{funcionarioClientBean.salvar()}" value="Salvar" process="@this url nome setor datanascimento datacontratacao" update="tabela url nome setor datanascimento datacontratacao" onsuccess="setTimeout ( '$(\'#form\\\\:msgs\').hide()', 4000);" oncomplete="$(function(){PrimeFaces.focus('form:nome');});"  ></p:commandButton>
                </p:panel>
                <p:panel header="Lista de Funcionário">
                    <p:dataTable sortBy="#{l.nome}" id="tabela" emptyMessage="Nenhum Funcionários encontrado ou URL inválido" var="l" value="#{funcionarioClientBean.lista}" >
                        <p:column headerText="Codígo" >
                            <p:outputLabel value="#{l.id}"></p:outputLabel>
                        </p:column>
                        <p:column headerText="Nome" sortBy="#{l.nome}"  > 
                            <p:outputLabel value="#{l.nome}"></p:outputLabel>
                        </p:column>
                        <p:column headerText="Setor" width="30%" > 
                            <p:outputLabel value="#{l.setor}"></p:outputLabel>
                        </p:column>
                        <p:column headerText="Ações" width="10%">
                            <p:commandButton icon="fa fa-pencil" action="#{funcionarioClientBean.editar(l.id)}" process="@this" update="form:nome form:setor form:datanascimento form:datacontratacao" oncomplete="$(function(){PrimeFaces.focus('form:nome');});"></p:commandButton>
                            <p:commandButton icon="fa fa-trash" action="#{funcionarioClientBean.deletar(l.id)}" process="@this" update="@this tabela" oncomplete="$(function(){PrimeFaces.focus('form:nome');});" onsuccess="setTimeout ( '$(\'#form\\\\:msgs\').hide()', 4000);"></p:commandButton>
                        </p:column>
                    </p:dataTable>
                </p:panel>
            </h:form>

        </h:body>

    </html>
</f:view>